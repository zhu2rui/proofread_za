# 文档标注器

一个基于HTML、CSS和JavaScript的文档标注器，支持通过右键菜单进行文本标注。

## 功能特点

1. **双图层设计**：底层是文档内容，上层是透明的Canvas用于绘制标注
2. **基于字符索引的标注**：使用`start_index`和`end_index`来精确定位标注范围
3. **右键菜单选择标注类型**：选中文本后右键出现菜单，可选择"框选"或"删除"标注
4. **Ctrl键多选**：按住Ctrl键可同时选择多个文本片段
5. **重叠标注处理**：新标注会自动清除与它重叠的旧标注
6. **自动生成JSON配置**：选中文本后自动生成对应的JSON配置
7. **自定义删除标记**：使用预定义的多阶贝塞尔曲线作为删除标记

## 使用方法

1. 在"文档内容"输入框中输入或粘贴要标注的文本
2. 在预览区域中选中要标注的文本
3. 右键点击选中的文本，从菜单中选择标注类型（"框选"或"删除"）
4. 标注会自动绘制在Canvas上
5. 可以通过"清除标注"按钮清除所有标注

## 技术实现

- **HTML Canvas API**：用于绘制标注框和删除标记
- **DOM Range API**：用于精确定位文本位置
- **事件处理**：处理鼠标选择、右键菜单等交互
- **JSON解析**：支持从JSON配置生成标注
- **自定义高亮**：实现文本选择的自定义高亮效果

## 文件结构

```
├── index.html      # 主页面
├── styles.css      # 样式文件
├── script.js       # 主要逻辑
├── bezier.html     # 贝塞尔曲线生成器
└── bezier-simulator.html  # 贝塞尔曲线模拟器
```

## 浏览器支持

- Chrome
- Firefox
- Safari
- Edge

## 开发说明

1. 可以直接在浏览器中打开`index.html`使用
2. 也可以启动本地Web服务器进行开发

```bash
# 使用Python 3
python -m http.server 8000

# 使用Node.js
npx http-server -p 8000
```

然后在浏览器中访问 `http://localhost:8000`

## 注意事项

1. 确保浏览器支持HTML5 Canvas和DOM Range API
2. 标注配置JSON格式：`{"start_index": 0, "end_index": 3}`
3. 支持多选配置：`[{"start_index": 0, "end_index": 3}, {"start_index": 5, "end_index": 8}]`
4. 贝塞尔曲线数据已预定义在代码中，无需手动配置

## 更新日志

- **v1.0.0**：初始版本，支持框选标注
- **v1.1.0**：添加删除标注类型，使用贝塞尔曲线作为删除标记
- **v1.2.0**：实现右键菜单选择标注类型，移除旧的标注类型按钮
- **v1.3.0**：优化用户体验，添加Ctrl键多选功能
- **v1.4.0**：修复重叠标注处理逻辑，改进贝塞尔曲线绘制
